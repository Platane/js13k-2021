<!doctype html><html><title>üê°‚öîÔ∏èüõ°</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:image" content="https://platane.github.io/js13k-2021/images/600x400.jpg"><meta name="description" content="A pretty blob simulation with zero gameplay. A game made for the 2021 js13kGames.com competition."><meta name="title" content="Delph"><meta name="viewport" content="width=device-width,initial-scale=1"><style>body{font-family:Helvetica,sans-serif;background-color:#f4f4f0}</style><body><canvas style="position:fixed;top:0;left:0;width:100%;height:100%;touch-action:none"></canvas><canvas style="position:fixed;top:0;left:0;width:100%;height:100%;touch-action:none"></canvas><footer style="position:fixed;bottom:0;right:0;padding:0 4px"><a id="splash-up" href="#">controls</a> <a href="https://github.com/Platane/js13k-2021">source</a></footer><div id="splash" style="position:fixed;top:0;left:0;width:100%;height:100%;backdrop-filter:blur(5px);transition:opacity .2s ease;padding:40px;color:#333;background-color:#ffffff66;text-shadow:0 0 3px #f8f8f6;font-size:1.2em"><h1>Delph</h1><span>üê°‚öîÔ∏èüõ°</span><h4>A pretty blob simulation<br>With zero gameplay</h4><br><br><h5>Controls:</h5><ul><li><b>Left Click</b> to select a blob</li><li><b>Right Click</b> to command the blob to move</li><li><b>Drag</b> the blob to split it in half</li><br><li>There is no goals, apart from enjoying the graphics <i>(sorry)</i></li></ul><br><br><button id="splash-dismiss" style="padding:20px">Let's go !</button></div></body><script>let t=Object.fromEntries(Array.from(new URLSearchParams(window.location.search).entries()).map(([t,n])=>[t,"0"!==n])),n={t:0,s:0,o:0,i:0,l:0};if(Object.assign(n,t),"all"in t)for(let e in n)n[e]=t.all;let e=[Array.from({length:26},()=>new Uint16Array([65536*(.2*Math.random()+.5),65536*(.16*Math.random()+.6)])),Array.from({length:14},()=>new Uint16Array([65536*(.12*Math.random()+.4),65536*(.14*Math.random()+.15)])),Array.from({length:16},()=>new Uint16Array([65536*(.2*Math.random()+.3),65536*(.14*Math.random()+.32)]))];e.forEach(t=>t.forEach(t=>{t[0]=(t[0]-32768)/4+32768,t[1]=(t[1]-32768)/4+32768})),Array.from({length:3}).map((t,n,{length:e})=>{t=n/e*Math.PI*2;let r=.5+.1*Math.sin(t),o=.5+.1*Math.cos(t);return Array.from({length:Math.floor(12*Math.random()+10)},()=>new Uint16Array([65536*(.08*Math.random()-.04+r),65536*(.08*Math.random()-.04+o)]))});var r,o=1/65536,a=[0,0],i=[65536,65536],l=[1,1],s=e.map(()=>[]),u=0,c=null,h=null,f="undefined"!=typeof Float32Array?Float32Array:Array;function M(t,n,e){var r=n[0],o=n[1],a=n[2],i=n[3],l=n[4],s=n[5],u=n[6],c=n[7];n=n[8];var h=e[0],f=e[1],M=e[2],m=e[3],v=e[4],d=e[5],p=e[6],y=e[7];e=e[8],t[0]=h*r+f*i+M*u,t[1]=h*o+f*l+M*c,t[2]=h*a+f*s+M*n,t[3]=m*r+v*i+d*u,t[4]=m*o+v*l+d*c,t[5]=m*a+v*s+d*n,t[6]=p*r+y*i+e*u,t[7]=p*o+y*l+e*c,t[8]=p*a+y*s+e*n}function m(t){var n=gt;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=t[0],n[7]=t[1],n[8]=1,n}function v(t){var n=gt;return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=t[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function d(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t}function p(t,n,e,r){t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r}function y(t,n){return Math.hypot(n[0]-t[0],n[1]-t[1])}function g(t,n){var e=n[0]-t[0];return e*e+(t=n[1]-t[1])*t}function b(t){return Math.hypot(t[0],t[1])}function w(t,n){var e=n[0],r=n[1];0<(e=e*e+r*r)&&(e=1/Math.sqrt(e)),t[0]=n[0]*e,t[1]=n[1]*e}function x(t,n){return t[0]*n[0]+t[1]*n[1]}function A(t,n,e,r){var o=n[0];n=n[1],t[0]=o+r*(e[0]-o),t[1]=n+r*(e[1]-n)}Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)}),r=new f(2),f!=Float32Array&&(r[0]=0,r[1]=0);let P=(t,n)=>{t[0][0]=Math.min(t[0][0],n[0]),t[0][1]=Math.min(t[0][1],n[1]),t[1][0]=Math.max(t[1][0],n[0]),t[1][1]=Math.max(t[1][1],n[1])},S=(t,n)=>{n.forEach(n=>P(t,n))},k=(t,n)=>{var e=t[0][0],r=t[1][0],o=n[0][0],a=n[1][0];return(e=e<=a&&o<=r||o<=r&&e<=a)&&(e=t[0][1],t=t[1][1],r=n[0][1],e=e<=(n=n[1][1])&&r<=t||r<=t&&e<=n),e},K=t=>(t[0][0]=Infinity,t[0][1]=Infinity,t[1][0]=-Infinity,t[1][1]=-Infinity,t),F=2.8/400*65536,T=Math.sqrt(-2*Math.log(.38)*F*F),B=(t,n,e)=>t.reduce((t,[r,o])=>(r=Math.hypot(n-r,e-o),t+Math.exp(-.5*r*r/(F*F))),0),U=Math.sqrt(-2*Math.log(.38)*F*F),I=U/4,j=[0,0],q=(t,n,e)=>{d(j,t[e],n=t[n]);var r=(e=b(j))-2*U;const o=Math.ceil(r/I);r=(r-(o-1)*I)/2;for(let a=0;a<o;a++){const i=o/2+(a%2?a/2:-(a+1)/2);if(!(.38<B(t,n[0]+j[0]/e*(U+r+i*I),n[1]+j[1]/e*(U+r+i*I))))return 0}return 1},D=(t,n,e=t.map((t,n)=>n))=>{const r=[n];for(-1!==(n=e.indexOf(n))&&e.splice(n,1),n=0;n<r.length;n++){const o=r[n];for(let n=e.length;n--;){const a=e[n];q(t,o,a)&&(e.splice(n,1),r.push(a))}}return r},[N,$]=Array.from(document.getElementsByTagName("canvas")),O=$.getContext("2d"),X=N.getContext("webgl2"),Y=Math.min(window.devicePixelRatio??1,2),z=()=>{const t=window.innerWidth*Y,n=window.innerHeight*Y;N.width=$.width=t,N.height=$.height=n,X.viewport(0,0,t,n),l=[t,n],o=Math.min(l[0]/i[0],l[1]/i[1])/l[0]*3,a[0]=(1-1/3)/2*-i[0],a[1]=(1-1/3)/2*-i[1]};z(),window.addEventListener("resize",z);let L=()=>o*Math.min(l[0],l[0])/Y,R=(t,n,e)=>(t[0]=Math.floor(n/L()-a[0]),t[1]=Math.floor(e/L()-a[1]),t),_=Symbol(),C=Symbol(),E=null,G=0,H=0,J=[0,0],Q=(t,n)=>{if(!(.38<B(n,t[0],t[1])))return null;let e=Infinity,r=0;return n.forEach((n,o)=>{(n=y(n,t))<e&&(e=n,r=o)}),D(n,r)},V=({pageX:t,pageY:n,button:r,ctrlKey:o,timeStamp:a})=>{switch(E=null,H=a,G=1,J[0]=t,J[1]=n,r){case 0:if(t=R([0,0],t,n),o)E=_,c=[t,t.slice()],h=null;else{if(!h||!((t,n,e)=>.38<B(t,n,e))((h??[]).map(t=>e[u][t]),t[0],t[1]))for(h=null,o=e.length;o--;)(n=Q(t,e[o]))&&(h=n,u=o);h&&4<=h.length&&(E=C)}break;case 2:const r=h;if(r){var i=u;s[i].forEach((t,n)=>{t.u=t.u.filter(t=>!r.includes(t)),0===t.u.length&&s[i].splice(n,1)}),s[i].push({u:r.slice(),target:{h:R([0,0],t,n)}})}}},W=({pageX:t,pageY:n})=>{switch(G=G&&50>y(J,[t,n]),E){case C:const o=d([0,0],J,[t,n]);if(100<b(o)){E=null,w(o,o);const a=u,i=h.slice().sort((t,n)=>x(o,e[a][t])-x(o,e[a][n]));var r=Math.floor(i.length/2);const l=i.slice(0,r),c=i.slice(r),f=[0,0];R(f,t,n),p(f,f,o,500+500*Math.sqrt(r));const M=K([[],[]]);c.forEach(t=>P(M,e[a][t])),A(t=[0,0],...M,.5),p(t,t,o,500+500*Math.sqrt(r)),s[a].forEach((t,n)=>{t.u=t.u.filter(t=>!i.includes(t)),0===t.u.length&&s[a].splice(n,1)}),s[a].push({u:l,target:{h:f}},{u:c,target:{h:t}}),h=l.slice()}break;case _:(r=c)[1][0]=Math.floor(t/L()-a[0]),r[1][1]=Math.floor(n/L()-a[1]);const i=(([[t,n],[e,r]])=>{const o=Math.min(t,e),a=Math.max(t,e),i=Math.min(n,r),l=Math.max(n,r);return([t,n])=>o<=t&&t<=a&&i<=n&&n<=l})(r);h=e[u].reduce((t,n,e)=>i(n)?[...t,e]:t,[])}},Z=({timeStamp:t})=>{if(E&&G&&240>t-H){t=R([0,0],J[0],J[1]);for(let n=e.length;n--;){const r=Q(t,e[n]);r&&(h=r,u=n)}}E=c=null},tt=(t,n)=>(n=X.createShader(n),X.shaderSource(n,t),X.compileShader(n),n),nt=[],et=[],rt=document.createElement("canvas");rt.width=rt.height=128;let ot=rt.getContext("2d");ot.scale(1.28,1.28),ot.fillStyle="orange",ot.beginPath(),ot.fillRect(0,0,100,100),ot.fillStyle="#f5ce88",ot.beginPath(),ot.moveTo(50,14),ot.lineTo(10,55),ot.lineTo(90,55),ot.fill(),ot.beginPath(),ot.arc(50,60,28,0,Math.PI),ot.fill();let{data:at}=ot.getImageData(0,0,128,128);et.push(at),nt.push(rt);let it=document.createElement("canvas");it.width=it.height=128;let lt=it.getContext("2d");lt.scale(1.28,1.28),lt.fillStyle="seagreen",lt.beginPath(),lt.fillRect(0,0,100,100),lt.fillStyle="#3fb774",lt.beginPath(),lt.moveTo(50,14),lt.lineTo(10,55),lt.lineTo(50,80),lt.lineTo(90,55),lt.fill();let{data:st}=lt.getImageData(0,0,128,128);et.push(st),nt.push(it);let ut=document.createElement("canvas");ut.width=ut.height=128;let ct=ut.getContext("2d");ct.scale(1.28,1.28),ct.fillStyle="#b73f2b",ct.beginPath(),ct.fillRect(0,0,100,100),ct.fillStyle="#bf5d4d",ct.beginPath(),ct.arc(50,60,28,0,Math.PI),ct.fill(),ct.beginPath(),ct.arc(50,40,28,-Math.PI,0),ct.fill();let{data:ht}=ct.getImageData(0,0,128,128);et.push(ht),nt.push(ut);let ft=document.createElement("canvas");ft.width=ft.height=128;let Mt=ft.getContext("2d");Mt.scale(1.28,1.28),Mt.fillStyle="#da9143",Mt.beginPath(),Mt.fillRect(0,0,100,100),Mt.fillStyle="#e09c52",Mt.beginPath(),Mt.arc(50,60,28,0,Math.PI),Mt.fill(),Mt.beginPath(),Mt.arc(50,40,28,-Math.PI,0),Mt.fill();let{data:mt}=Mt.getImageData(0,0,128,128);et.push(mt),nt.push(ft);let vt=et.map(t=>`rgb(${t[0]},${t[1]},${t[2]})`);Array.from({length:400},()=>({u:[0],M:[[0,0],[0,0]]}));let dt=Array.from({length:400},()=>({u:e.map(()=>[]),M:[[0,0],[0,0]]})),pt=t=>{let n=0;e.map((e,r)=>e.forEach((e,o)=>{const a=dt[n++];a.M[0][0]=e[0]-t,a.M[0][1]=e[1]-t,a.M[1][0]=e[0]+t,a.M[1][1]=e[1]+t,a.u.forEach(t=>t.length=0),a.u[r].push(o)}));let r=1;for(;r;){r=0;for(let t=0;t<n;t++)for(let e=t+1;e<n;e++)k(dt[t].M,dt[e].M)&&(S(dt[t].M,dt[e].M),dt[e].u.forEach((n,r)=>{dt[t].u[r].push(...dt[e].u[r])}),dt.push(...dt.splice(e,1)),n--,r=1)}return dt.slice(0,n)};var yt=new f(9);f!=Float32Array&&(yt[1]=0,yt[2]=0,yt[3]=0,yt[5]=0,yt[6]=0,yt[7]=0),yt[0]=1,yt[4]=1,yt[8]=1;let gt=yt;const bt=tt("#version 300 es\nuniform highp mat3 worldMatrix;\nin vec2 position;\nin float iBox;\nout vec2 pos;\nflat out int iB;\nvoid main() {\nvec3 p = vec3(position, 1.0);\ngl_Position = vec4(worldMatrix * p, 1.0);\npos = position.xy;\niB = int(iBox);\n}",X.VERTEX_SHADER),wt=tt("#version 300 es\nprecision highp float;\nuniform highp usampler2D pointTexture;\nuniform highp sampler2D bannerTexture;\nuniform highp float tauSquare;\nuniform highp float threshold;\nuniform int nPoint;\nuniform int nK;\nin vec2 pos;\nflat in int iB;\nout vec4 color;\nfloat gauss(float x) { return exp(-0.5 * (x * x) / (tauSquare)); }\nvoid main() {\n// color = vec4(0.0, 0.0, 0.0, 0.05);\nfloat bestSum = 0.0;\nint bestK = -1;\nfor (int k = 0; k < nK; k++) {\nfloat sum = 0.0;\nfor (int i = 0; i < nPoint; i++) {\nuvec2 uPointPosition =\ntexelFetch(pointTexture, ivec2(iB * nK + k, i), 0).xy;\nvec2 pointPosition = vec2(uPointPosition.xy);\nif (pointPosition.x != 0.0 || pointPosition.y != 0.0) {\nfloat d = distance(pointPosition, pos);\nsum += gauss(d);\n}\n}\nif (sum > threshold && sum > bestSum) {\nbestSum = sum;\nbestK = k;\n}\n}\nif (bestK >= 0) {\nfloat m = 0.0006;\nfloat w = 1.0 / float(nK);\nfloat y = floor(pos.y * m);\nvec2 u = vec2(\n//\n(mod((pos.x) * m + 0.5 * mod(y, 2.0), 1.0) * 0.96 + 0.02) * w +\nw * float(bestK),\n//\nmod(pos.y * m, 1.0) * 0.96 + 0.02);\ncolor = texture(bannerTexture, u);\ncolor.w = (bestSum - threshold) / (threshold * 0.1);\n}\n}\n",X.FRAGMENT_SHADER),xt=X.createProgram();X.attachShader(xt,bt),X.attachShader(xt,wt),X.deleteShader(bt),X.deleteShader(wt),X.linkProgram(xt),X.useProgram(xt);let At=e.length,Pt=16*At,St=X.createTexture(),kt=new Uint16Array(256*Pt),Kt=X.getUniformLocation(xt,"pointTexture");X.activeTexture(X.TEXTURE1),X.bindTexture(X.TEXTURE_2D,St),X.uniform1i(Kt,1),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.NEAREST),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.NEAREST);let Ft=X.createTexture(),Tt=X.getUniformLocation(xt,"bannerTexture");X.activeTexture(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Ft),X.uniform1i(Tt,0);let Bt=document.createElement("canvas");Bt.width=e.length*nt[0].width,Bt.height=nt[0].height;let Ut=Bt.getContext("2d");e.forEach((t,n)=>{Ut.drawImage(t=nt[n%nt.length],n*t.width,0)}),X.texImage2D(X.TEXTURE_2D,0,X.RGBA,Bt.width,Bt.height,0,X.RGBA,X.UNSIGNED_BYTE,Bt),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.NEAREST),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.NEAREST),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.generateMipmap(X.TEXTURE_2D),X.uniform1f(X.getUniformLocation(xt,"tauSquare"),F*F),X.uniform1f(X.getUniformLocation(xt,"threshold"),.38),X.uniform1i(X.getUniformLocation(xt,"nK"),e.length);let It=X.getUniformLocation(xt,"nPoint"),jt=X.getUniformLocation(xt,"worldMatrix"),qt=new Float32Array(9),Dt=X.createBuffer(),Nt=new Float32Array(192),$t=X.getAttribLocation(xt,"position");X.bindBuffer(X.ARRAY_BUFFER,Dt),X.enableVertexAttribArray($t),X.vertexAttribPointer($t,2,X.FLOAT,0,0,0),X.bufferData(X.ARRAY_BUFFER,Nt,X.STATIC_DRAW),X.bindAttribLocation(xt,$t,"position");let Ot=X.createBuffer(),Xt=new Float32Array(96);for(let t=16;t--;)Xt.fill(t,6*t,6*(t+1));let Yt=X.getAttribLocation(xt,"iBox");X.bindBuffer(X.ARRAY_BUFFER,Ot),X.enableVertexAttribArray(Yt),X.vertexAttribPointer(Yt,1,X.FLOAT,0,0,0),X.bufferData(X.ARRAY_BUFFER,Xt,X.STATIC_DRAW),X.bindAttribLocation(xt,Yt,"iBox");let zt=[0,0],Lt=[0,0],Rt=[0,0],_t=[0,0],Ct=[0,0],Et=(t,n,e)=>{const r=[0,0,0];return _t[0]=(t[0]+n[0])/2,_t[1]=(t[1]+n[1])/2,Ct[0]=(e[0]+n[0])/2,Ct[1]=(e[1]+n[1])/2,Lt[0]=t[1]-n[1],Lt[1]=-(t[0]-n[0]),Rt[0]=n[1]-e[1],Rt[1]=-(n[0]-e[0]),Math.abs(Lt[0]*Rt[1]-Lt[1]*Rt[0])<Number.EPSILON?Math.abs(Lt[0]*(_t[1]-Ct[1])-Lt[1]*(_t[1]-Ct[1]))<Number.EPSILON&&(r[0]=_t[0],r[1]=_t[1]):(n=Math.abs(Rt[0])<Number.EPSILON?(Ct[0]-_t[0])/Lt[0]:Math.abs(Rt[1])<Number.EPSILON?(Ct[1]-_t[1])/Lt[1]:((_t[0]-Ct[0])/Rt[0]-(_t[1]-Ct[1])/Rt[1])/(Lt[1]/Rt[1]-Lt[0]/Rt[0]),r[0]=_t[0]+Lt[0]*n,r[1]=_t[1]+Lt[1]*n),r[2]=g(t,r),r},Gt=[[0,0],[0,0]],Ht=t=>{S(K(Gt),t),Gt[0][0]-=1e6,Gt[0][1]-=1e6,Gt[1][0]+=1e6,Gt[1][1]+=1e6;var n=[[Gt[0][0],Gt[0][1]],[Gt[0][0],Gt[0][1]+2*(Gt[1][1]-Gt[0][1])],[Gt[0][0]+2*(Gt[1][0]-Gt[0][0]),Gt[0][1]]];const e=t.length;t.push(...n);const r=[[e,e+1,e+2]];n=[Et(...n)];for(let i=e;i--;){const e=t[i],l=[];for(var o=n.length;o--;)if(g(e,n[o])<=n[o][2]){var a=r[o];n.splice(o,1),r.splice(o,1);for(let t=3;t--;){const n=a[t],e=a[(t+1)%3],r=l.findIndex(([t,r])=>t===n&&r===e||t===e&&r===n);-1<r?l.splice(r,1):l.push([n,e,0])}}for(o=l.length;o--;)(a=l[o])[2]=i,n.push(Et(t[a[0]],t[a[1]],e)),r.push(a)}for(n=r.length;n--;)(r[n][0]>=e||r[n][1]>=e||r[n][2]>=e)&&r.splice(n,1);return t.splice(e,3),r},Jt=(t,n,e,r,o,a)=>{const i=T/100;for(;Math.abs(o-a)>i;){const t=(o+a)/2;.38<B(n,e[0]+t*r[0],e[1]+t*r[1])?o=t:a=t}return t[0]=e[0]+(n=(o+a)/2)*r[0],t[1]=e[1]+n*r[1],t},Qt=[1,0],Vt=[1,0],Wt=[0,0],Zt=[0,0],tn=(t,n,e)=>{var r=[0,0],o=nn;let a=e;Vt[0]=o[1],Vt[1]=-o[0];for(let i=3;i--;){if(p(Wt,n,o,a),p(Wt,Wt,Vt,-e/2),p(Zt,Wt,Vt,e),.38<B(t,Wt[0],Wt[1])&&!(.38<B(t,Zt[0],Zt[1])))return Jt(r,t,Wt,Vt,0,e);a/=2}return null},nn=[0,0],en=[1,0],rn=t=>{var n=T/3;let e=(t=>{var n=[0,0];((t,n)=>{t[0]=n[0],t[1]=n[1]})(n,t.reduce((t,n)=>t[0]>n[0]?t:n));const e=T/1.2;n[0]+=.9*T;for(let r=100;r--;)if(n[0]+=e,!(.38<B(t,n[0],n[1])))return Jt(n,t,n,Qt,-e,0);return null})(t);var r=[e[0],e[1]-1];const o=[e];for(let i=200;i--;){let i;if(d(nn,e,r),w(nn,nn),i=tn(t,e,n),!i){var a=nn;for((r=en)[0]=a[1],r[1]=-a[0],r=5;!i&&r--;)A(nn,nn,en,.5),w(nn,nn),i=tn(t,e,n)}if(!i)return null;if(r=e,e=i,4<o.length&&y(o[0],e)<1.6*n){0<x(t=d([0,0],o[0],e),nn)&&o.push(e);break}o.push(e)}return o},on=(2.6*T)**2,an=t=>{const n=t.shift();if(!n)return[];const e=[n.m];let r;for(r=n;r=ln(t,r);)e.push(r.m);for(r=n;r=ln(t,r);)e.unshift(r.m);return t=an(t),2<=e.length&&t.push({v:n.v,p:n.p,line:e}),t},ln=(t,n)=>{for(let e=t.length;e--;){const r=t[e];for(let o=n.e.length;o--;)for(let a=r.e.length;a--;)if(n.e[o]===r.e[a])return n.e.splice(o,1),r.e.splice(a,1),t.splice(e,1),r}return null},sn=[0,0],un=[0,0],cn=[0,0],hn=e.map(()=>Array.from({length:128},()=>[0,0])),fn=1/60,Mn=t=>{720>t&&(t=720);const n=1.1*T;let e=8e8/(t*t);return t>n&&(e/=(1+(t-n)/(.5*T))**4),t>1.3*n&&(e=0),e},mn=Date.now()/1e3,vn=0,dn=()=>{var t=Date.now()/1e3;for(let n=0;100>n&&mn+.016666666666666666*vn<=t;vn++,n++)pt(1.5*T).forEach(t=>{const n=[],r=[];t.u.forEach((t,o)=>t.forEach(t=>{n.push(e[o][t]),r.push(o)}));const o=Ht(n),a=2<=t.u.reduce((t,n)=>t+ +!!n.length,0)?((t,n,e)=>{const r=[];return e.forEach(e=>{if(!(n[e[0]]!==n[e[1]]&&n[e[0]]!==n[e[2]]&&n[e[1]]!==n[e[2]]||n[e[0]]===n[e[1]]&&n[e[0]]===n[e[2]]))for(let u=3;u--;){const c=e[u],h=e[(u+1)%3],f=e[(u+2)%3];if(n[c]===n[h]&&(g(t[f],t[c])<on||g(t[f],t[h])<on)){var o=r,a=o.push,i=t[f],l=t[c],s=t[h];i=new Uint16Array([((i[0]+l[0])/2+(i[0]+s[0])/2)/2,((i[1]+l[1])/2+(i[1]+s[1])/2)/2]),a.call(o,{m:i,v:Math.min(n[c],n[f]),p:Math.max(n[c],n[f]),e:[Math.min(c,f)*t.length+Math.max(c,f),Math.min(h,f)*t.length+Math.max(h,f)]})}}}),an(r)})(n,r,o):[];t.u.forEach((n,r)=>n.forEach(n=>{const o=e[r][n],i=hn[r][n];i[0]=0,i[1]=0;const l=s[r].find(t=>t.u.includes(n));t.u[r].forEach(t=>{(t=e[r][t])!==o&&(d(un,t,o),t=b(un),p(i,i,un,-Mn(t)*(l?1:.8)/t))}),l&&(d(un,l.target.h,o),w(un,un),p(i,i,un,3e3)),l&&a.forEach(({line:t})=>{for(let l=t.length-1;l--;){var n=t[l];d(cn,t[l+1],n);const s=b(cn);var e=1/s,r=cn,a=cn;r[0]=a[0]*e,r[1]=a[1]*e,(e=un)[0]=(r=cn)[1],e[1]=-r[0],d(sn,o,n),n=x(cn,sn),0>(e=x(un,sn))&&(a=r=un,r[0]=-a[0],r[1]=-a[1]),r=Math.max(800,Math.abs(e)),-T/10<n&&n<s+T/10&&Math.abs(e)<1.4*T&&p(i,i,un,5e6/r)}})})),t.u.forEach((t,n)=>t.forEach(t=>{const r=e[n][t];r[0]+=(t=hn[n][t])[0]*fn,r[1]+=t[1]*fn}))}),s.forEach((t,n)=>t.forEach((t,r)=>{for(let r=t.u.length;r--;)400>y(e[n][t.u[r]],t.target.h)&&t.u.splice(r,1);0===t.u.length&&s[n].splice(r,1)}));if(O.clearRect(0,0,99999,99999),O.save(),t=Math.min(l[0],l[0])*o,O.g=1/t*Y,O.scale(t,t),O.translate(a[0],a[1]),O.lineWidth=.25*O.g,O.strokeStyle="#000",c){const[[t,n],[e,r]]=c;O.strokeRect(t,n,e-t,r-n)}if((()=>{if(h){const n=u,r=h.slice();for(O.save(),O.lineWidth=3*O.g,O.strokeStyle="#666";r.length;){var t=D(e[n],r[0],r);if(t=rn(t.map(t=>e[n][t]))){O.beginPath(),O.moveTo(t[0][0],t[0][1]);for(let n=t.length;n--;)O.lineTo(t[n][0],t[n][1]);O.stroke()}}O.restore()}})(),n.i&&(O.lineWidth=.5/O.A,pt(1.6*T).forEach(({M:t})=>{O.strokeStyle="purple",O.beginPath(),O.strokeRect(t[0][0],t[0][1],t[1][0]-t[0][0],t[1][1]-t[0][1])})),n.s&&(O.lineWidth=.8*O.g,pt(1.6*T).forEach(({u:t})=>{const n=[],r=[];t.forEach((t,o)=>t.forEach(t=>{n.push(e[o][t]),r.push(o)})),t=Ht(n);const o=n.map(()=>[]);t.forEach(t=>{for(let e=3;e--;){var n=(e+1)%3;const r=Math.min(t[e],t[n]);n=Math.max(t[e],t[n]),o[r]=o[r]||[],o[r].includes(n)||o[r].push(n)}}),o.forEach((t,e)=>t.forEach(t=>{O.strokeStyle=r[e]!=r[t]?"purple":"blue",O.beginPath(),O.moveTo(n[e][0],n[e][1]),O.lineTo(n[t][0],n[t][1]),O.stroke()}))})),n.o&&(e.forEach((t,n)=>{for(const[e,r]of t)O.fillStyle="#333",O.beginPath(),O.arc(e,r,5*O.g,0,2*Math.PI),O.fill(),O.fillStyle=vt[n],O.beginPath(),O.arc(e,r,3*O.g,0,2*Math.PI),O.fill()}),(h||[]).forEach(t=>{const[n,r]=e[u][t];O.fillStyle="#aaa",O.beginPath(),O.arc(n,r,3.2*O.g,0,2*Math.PI),O.fill()}),O.lineWidth=1*O.g,s.forEach((t,n)=>t.forEach(t=>{t.u.forEach(r=>{d(zt,t.target.h,r=e[n][r]),w(zt,zt),p(zt,r,zt,20*O.g),O.beginPath(),O.moveTo(r[0],r[1]),O.lineTo(zt[0],zt[1]),O.stroke()})}))),n.t){for(O.lineWidth=.7*(t=O.g),O.fillStyle=O.strokeStyle="purple",O.font=`${Math.floor(8*t)}px sans-serif `,O.beginPath(),O.moveTo(10*t,17*t),O.lineTo(10*t,20*t),O.lineTo(10*t+1e3,20*t),O.lineTo(10*t+1e3,17*t),O.stroke(),O.beginPath(),O.fillText(Intl.NumberFormat().format(1e3),10*t,16*t),O.beginPath(),O.moveTo(10*t,47*t),O.lineTo(10*t,50*t),O.lineTo(10*t+1e4,50*t),O.lineTo(10*t+1e4,47*t),O.stroke(),O.beginPath(),O.fillText(Intl.NumberFormat().format(1e4),10*t,46*t),O.save(),O.translate(10*t,120*t),O.strokeStyle="black",O.beginPath(),O.moveTo(0,0),O.lineTo(1e4,0),O.stroke(),O.strokeStyle="red",O.beginPath(),O.moveTo(0,0),t=0;1e4>t;t+=50)O.lineTo(t,.4*-Mn(t));O.stroke(),O.restore()}O.restore(),(()=>{const t=pt(1.6*T);kt.fill(0),t.forEach(({M:t,u:n},r)=>{Nt[12*r]=t[0][0],Nt[12*r+1]=t[0][1],Nt[12*r+2]=t[1][0],Nt[12*r+3]=t[0][1],Nt[12*r+4]=t[1][0],Nt[12*r+5]=t[1][1],Nt[12*r+6]=t[1][0],Nt[12*r+7]=t[1][1],Nt[12*r+8]=t[0][0],Nt[12*r+9]=t[1][1],Nt[12*r+10]=t[0][0],Nt[12*r+11]=t[0][1],n.forEach((t,n)=>t.forEach((t,o)=>{const[a,i]=e[n][t];128>o&&(kt[0+(t=2*(o*Pt+(r*At+n)))]=a,kt[t+1]=i)}))});const n=Math.max(...t.map(({u:t})=>t.map(({length:t})=>t)).flat());X.useProgram(xt),X.uniform1i(It,n),(()=>{var t=qt,n=l[0]/l[1],e=1/o;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,M(t,m(a),t),M(t,v([1/e,1/e]),t),M(t,v([2,2]),t),M(t,v([1,n]),t),M(t,m([-1,-1]),t),M(t,v([1,-1]),t)})(),X.uniformMatrix3fv(jt,0,qt),X.bindBuffer(X.ARRAY_BUFFER,Dt),X.bufferData(X.ARRAY_BUFFER,Nt,X.DYNAMIC_DRAW),X.activeTexture(X.TEXTURE1),X.bindTexture(X.TEXTURE_2D,St),X.texImage2D(X.TEXTURE_2D,0,X.RG16UI,Pt,128,0,X.RG_INTEGER,X.UNSIGNED_SHORT,kt),X.activeTexture(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Ft),X.clear(X.COLOR_BUFFER_BIT),X.drawArrays(X.TRIANGLES,0,6*t.length)})(),requestAnimationFrame(dn)};dn();let pn,yn=()=>{clearTimeout(pn);const t=Array.from({length:Math.floor(e[0].length)},(t,n)=>n);s[0].length=0,s[0].push({u:t,target:{h:new Uint16Array([(.2*Math.random()+.4)*i[0],(.2*Math.random()+.4)*i[1]])}}),pn=setTimeout(yn,3e3)};yn();let gn=()=>{clearTimeout(pn),document.addEventListener("mousemove",W),document.addEventListener("mousedown",V),document.addEventListener("mouseup",Z),document.addEventListener("contextmenu",t=>t.preventDefault());const t=document.getElementById("splash");t.style.opacity="0",t.style.pointerEvents="none"};n.l&&gn(),document.getElementById("splash-dismiss").addEventListener("click",gn),document.getElementById("splash-up").addEventListener("click",()=>{let t=document.getElementById("splash");t.style.opacity="1",t.style.pointerEvents="auto"});</script></html>